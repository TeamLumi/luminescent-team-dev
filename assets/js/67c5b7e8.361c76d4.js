"use strict";(globalThis.webpackChunkluminescent_team=globalThis.webpackChunkluminescent_team||[]).push([[315648],{28453(e,t,n){n.d(t,{R:()=>r,x:()=>a});var i=n(296540);const o={},s=i.createContext(o);function r(e){const t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:t},e.children)}},431429(e,t,n){n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>a,default:()=>c,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"art/mesh_and_texture_replacement","title":"Mesh & Texture Replacement Tutorial","description":"Tools Used:","source":"@site/rom-hacking/art/mesh_and_texture_replacement.md","sourceDirName":"art","slug":"/art/mesh_and_texture_replacement","permalink":"/luminescent-team-dev/rom-hacking/art/mesh_and_texture_replacement","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var o=n(474848),s=n(28453);const r={},a="Mesh & Texture Replacement Tutorial",h={},l=[{value:"Trainer Model Creation",id:"trainer-model-creation",level:2},{value:"Model Importing",id:"model-importing",level:2},{value:"Texture Editing",id:"texture-editing",level:2},{value:"Texture Editing FOR TRAINERS",id:"texture-editing-for-trainers",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"mesh--texture-replacement-tutorial",children:"Mesh & Texture Replacement Tutorial"})}),"\n",(0,o.jsx)(t.p,{children:"Tools Used:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"https://github.com/Perfare/AssetStudio",children:"Assetstudio"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"https://github.com/nesrak1/UABEA/releases",children:"UABEA"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"https://pastebin.com/raw/iCpxzSEF",children:"Melonscript"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"https://github.com/Unity-Technologies/AssetBundles-Browser",children:"Assetbundle Browser"})}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"trainer-model-creation",children:"Trainer Model Creation"}),"\n",(0,o.jsx)(t.p,{children:"By smore"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Rip model from the game as an FBX using Assetstudio"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["The models for trainers can be found in ",(0,o.jsx)(t.code,{children:"Data>StreamingAssetsAssetAssistant>Characters>persons"})," within your dumped game files. Find the file for the character you want via trial and error, opening them in Assetstudio to view their assets. To export, select the Mesh, Animator, and eye01_b AnimationClip, and under Export at the toolbar, select Animator+Selected Animation Clips. You can also export the textures here, though the basecolors can\u2019t be exported. I suggest going to Options>Export Options and selecting Tga, that way the alpha channel is retained and can be easily edited in photoshop. Pink exported Normalmaps can be restored to their normal blue form by rearranging the channels as such:"]}),"\n",(0,o.jsx)(t.li,{children:"The uti/ filename_U textures (they\u2019re usually deep blue) contain the PBR maps. If you decide to edit them, plug in each of your maps into one document\u2019s channels as follows:"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Make the desired mesh edits in 3d modeling software of your choice."}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"In my experience, it\u2019s easiest to get working if you combine everything onto one UV/Texture sheet, including the parts of the body that are being transferred over from the original mesh."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsx)(t.p,{children:"Transfer the rigging."}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"If you created new meshes, as opposed to just editing the base mesh, you will need to transfer the skinning from the original mesh to your new version. I did this in 3DSmax, so for me, that went like this, but it will vary depending on your program:"}),"\n",(0,o.jsx)(t.li,{children:"Open the original base fbx with skin and bones. Import your new mesh to that document. Rotate your new mesh 90 degrees so it\u2019s lying on its back(I don\u2019t know why but I had to do this for it to work), and Reset its Xform. Copy the Skin modifier from the original mesh. You can hide that mesh now, or even delete it. Paste that Skin modifier onto the new mesh. Here, you can start editing the weight-painting for the skin, if you want, but I recommend skipping that until everything\u2019s working in-game and coming back to it later. The skin should copy over with the majority of the rigging intact."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"model-importing",children:"Model Importing"}),"\n",(0,o.jsx)(t.p,{children:"By Leaf"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"Rip model from the game as an FBX using Assetstudio"}),"\n",(0,o.jsx)(t.li,{children:"Make the desired mesh edits in 3d modeling software of your choice."}),"\n",(0,o.jsxs)(t.li,{children:["Export as FBX from 3d modeling software.","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"If using Blender, a special FBX exporter is required- look into both BetterFBX and UnityFBX and see which works for you. 3ds Max users will not have this issue."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"Import both your edited model and the original model into Unity"}),"\n",(0,o.jsx)(t.li,{children:"Create two folders inside your unity project\u2019s \u201cassets\u201d folder- \u201cEditor\u201d and \u201cExport\u201d"}),"\n",(0,o.jsx)(t.li,{children:"Place the Melonscript into the Editor folder."}),"\n",(0,o.jsx)(t.li,{children:"Drag both the original model and the edited model into the scene view to place them in the scene"}),"\n",(0,o.jsx)(t.li,{children:"Go to Tools>melonscript>Generate Skinned Mesh Component to open the Melonscript UI."}),"\n",(0,o.jsxs)(t.li,{children:["Drag the original model\u2019s mesh component into the Base Mesh tab","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"The mesh component should be called something like \u201cpm0001_00_00_skin\u201d"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"Click the + icon under the Base Mesh tab, then drag the edited mesh\u2019s mesh component into the Element 0 tab"}),"\n",(0,o.jsxs)(t.li,{children:["Click generate, and a brand new mesh should be created in your Export folder.","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"Sometimes, as a result of different unit measurements between different programs, the new mesh can be too small. To check for this and other potential complications without having to load it in game, replace the mesh component of the skinnedmeshrenderer of the original model in your scene view with the one you just created, to check if there are any deformities. If there are deformities as a result of size, try setting the original model\u2019s scale factor (Not the scale in the scene!) to 100."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["In the assets view on the bottom of the screen, find the edited model and expand its components using the small arrow. Then, click on the mesh component and use Edit>Duplicate to create a copy of the mesh. Rename this to something you will be able to spot later, like \u201cPokemon Textures.\u201d","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"This is necessary because the Melonscript does not preserve submesh data, so we are going to use the submesh data from this later. You can ignore this step and related subsequent steps if your mesh only needs one submesh."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"Under Window, open AssetBundle Browser."}),"\n",(0,o.jsx)(t.li,{children:"Drag the \u201cPokemon Textures\u201d Mesh and the newly created mesh in the Export folder into the window."}),"\n",(0,o.jsx)(t.li,{children:"Switch to the Build tab and click the large Build button"}),"\n",(0,o.jsxs)(t.li,{children:["Locate the Assetbundle you just created for the new mesh and open it in UABEA, selecting that you want to compress to memory.","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"The Assetbundles should be in My project>AssetBundles>StandaloneWindows. Ignore the files labeled .manifest"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"Go to info. Select the Mesh component of your Assetbundle. Select Export Dump on the side to dump the mesh as a text file."}),"\n",(0,o.jsx)(t.li,{children:"Repeat steps 16 and 17 for the \u201cPokemon Textures\u201d Assetbundle."}),"\n",(0,o.jsxs)(t.li,{children:["Open both text files in a text editor. Copy over the submesh data from the \u201cPokemon Textures'' file into the New Mesh\u2019s file, replacing the array that is already there.","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"It will start the line that says \u201c1 Array Array (x items)\u201d and end where the indentation ends."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"Use UABEA to open the original BDSP game file that contains the mesh component you want to replace."}),"\n",(0,o.jsx)(t.li,{children:"Under info, locate the mesh component and select \u201cimport dump.\u201d Then select the new mesh\u2019s text file to overwrite the original."}),"\n",(0,o.jsxs)(t.li,{children:["Save the file.","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"Note that UABEA cannot overwrite the original file, as it will cause it to crash (and you don\u2019t want to do this anyways.) Save it instead to your desktop or some other folder where it will be safe"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Congratulations, you should hopefully have a working game file with your new mesh. Put it in your romfs folder and load up the game to check it out."}),"\n",(0,o.jsx)(t.h2,{id:"texture-editing",children:"Texture Editing"}),"\n",(0,o.jsx)(t.p,{children:"Hi all, Indigo hijacking the document here from Leaf hehehe, anyways i\u2019m going to show you how to add textures to your shiny new model!"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"So you\u2019ve gotten your model in the game? Great job, the hard part is over, kinda. A common issue with models run through Melonscript is that material groups get all wonky. This means that the textures that should be in one area are now in another, but don\u2019t fret this can be fixed!"}),"\n",(0,o.jsx)(t.li,{children:"Typically I like to compile my model\u2019s field and common files and open all of it in asset studio. I then open it up in Blender. If you check the material groups in blender, this should give you a good idea of how things have been moved around."}),"\n",(0,o.jsx)(t.li,{children:"The next step is to open the XX_00_00 field file in UABEA. From here, I recommend extracting each material file as a .json file and opening it in notepad++."}),"\n",(0,o.jsx)(t.li,{children:"In the Col0tex section of each .json file, I verify the pathID of each texture and make sure it matches the right texture that is in the XX_00_00 file from the common folder. You can easily verify the pathID in Asset Studio."}),"\n",(0,o.jsx)(t.li,{children:"After you mix and match each texture to the right respective areas, also verify that the X&Y scales of each col0tex section is each set to 1."}),"\n",(0,o.jsxs)(t.li,{children:["So in the off-chance that the eye materials were moved, after the textures are fixed, the wrong area of the body might play a blinking animation. This is because the animation is also mix-matched due to the materials being mixed up. Let\u2019s start by opening \u201cPokemonCustomNodeAnim\u201d.","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"This is a monobehaviour file in the XX_00_00 file in the field folder. Be sure to export this as a .JSON before opening it in notepad++"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"CTRL+F to find the path-ids of the eye groups in notepad++ (IDs are found using asset studio) and change them to the swapped material group in order to make the new eye group blink instead of the randomly assigned area."}),"\n",(0,o.jsx)(t.li,{children:"Okay, so now it should look okay, but now there are weird shadows everywhere! No biggy, this has to do with .AMB files and your normals. These are image files that provide your textures with a sense of depth and allow shadows to work properly."}),"\n",(0,o.jsx)(t.li,{children:"Download the image below, and using UABEA, open the XX_00 file in your common folder and replace all images with the .amb extension with this by using the plugins option on the side menu and then using the edit texture button."}),"\n",(0,o.jsxs)(t.li,{children:["Next find your normal col files, these should be reddish pink images. Using a photo editing software like clip studio paint or photoshop, stretch it out to be twice it\u2019s length. Then replace the image file.","\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"This is only good if the same pokemon or similar pokemon base is being used. In any other case typically a normal map can be found, the same steps would be followed, but with the new image."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.li,{children:"Now follow step #9 and insert the new texture, be sure to set the wrap options to repeat and repeat."}),"\n",(0,o.jsx)(t.li,{children:"Save the files and now put them all in your mods folder. Boot up your game and you should be good to go."}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"texture-editing-for-trainers",children:"Texture Editing FOR TRAINERS"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"The first step is to open asset studio and open your edited trainer file. What's most important is that you find the textures. When you find these textures you should look for the path ids. A path ID is essentially the way the game knows where these textures are and where they can pull them from."}),"\n",(0,o.jsx)(t.li,{children:"Once you find the path IDs, open the edited trainer file in UABEA, and find the material files. Export them all in one location and open them in notepad++ as .json files."}),"\n",(0,o.jsx)(t.li,{children:'For trainers, the most important line to look for is "_MainTex", if you can\'t find this, control + f the keywords. What you\'re going to look for underneath this is "m_PathID". This is the area that determines what texture is being pulled for this material. Cross compare it with the textures in asset studio to make sure it\'s pointing to the right images. Also verify that "m_scale" is set to 1 for both x and y underneath.'}),"\n",(0,o.jsx)(t.li,{children:"Save these edited material .jsons and reimport them back into UABEA. Save the edited file and test it in ryujinx."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Reach out to Indigo #7051 on discord with any questions"})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);